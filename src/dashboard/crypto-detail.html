<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <title id="title-name">Market View</title>
    <link rel="icon" href="/images/thumnails/original_logo.png" type="image/png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/styles/logged-user/user-header.css">
    <link rel="stylesheet" href="/styles/logged-user/chart-styles.css">
    <link rel="stylesheet" href="/styles/logged-user/crypto-detail.css">


    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Montserrat:wght@400;700&family=Roboto&display=swap" rel="stylesheet">

    <!-- Scripts -->
    <script src="/config.js"></script>
    <script src="/scripts/main-scripts/globalProvider.js"></script>
    <script src="/scripts/main-scripts/set-profile.js" defer></script>
    <script src="/scripts/user-dashboard/crypto-searcher.js"></script>

    <script src="/scripts/crytpo-detail.js" defer></script>
    <script src="/scripts/chart-script.js"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>
</head>
<body>
    <header class="header">
        <!-- Left Section: Logo and Brand Name -->
        <a href="/dashboard" class="header-left" id="header-left-side">
          <img src="/images/thumnails/logo.png" alt="Fundy Logo" class="logo">
          <h1 class="logo-text">Fundy</h1>
        </a>
      
        <!-- Center Section: Search Bar -->
        <div class="header-center">
          <!-- Search Bar with Icon -->
          <div class="search-container">
            <img src="/images/search.png" alt="Search Icon" class="search-icon">
            <input type="text" class="header-search" placeholder="Type / Search a crypto" id="crypto-search-input" autocomplete="off"/>
            <div id="search-results" class="search-results hidden"></div>
          </div>
        </div>
      
        <!-- Right Section: Gear, Notification, and User Icons -->
        <div class="header-right">
    
          <button class="promotion-button">
            <span>Upgrade Now</span>
            <img src="/images/icons/rocket-lunch.png" alt="Promotion Icon"/>
          </button>
          
          <!-- Gear Icon (Settings) -->
          <img src="/images/icons/setting.png" alt="Settings Icon" class="gear-icon" tabindex="0" role="button" aria-label="Settings" onclick="openSettings(event)" />
          <!-- Settings Menu -->
          <div id="settings-menu" class="settings-menu">
            <ul class="settings-links">
              <!-- LANGUAGE -->
              <li>
                <span>Language</span>
                <select class="menu-select" id="language-select">
                  <option value="en">English (EN)</option>
                  <option value="es">Español (ES)</option>
                  <option value="fr">Français (FR)</option>
                  <option value="de">Deutsch (DE)</option>
                  <option value="zh">中文 (ZH)</option>
                </select>
              </li>
          
              <!-- CURRENCY -->
              <li>
                <span>Currency</span>
                <select class="menu-select" id="currency-select">
                  <option value="usd">USD</option>
                  <option value="btc">BTC</option>
                  <option value="eur">EUR</option>
                  <option value="mxn">MXN</option>
                  <option value="gbp">GBP</option>
                </select>
              </li>
          
              <!-- DARK MODE -->
              <li>
                <span>Dark Mode</span>
                <label class="switch">
                  <input type="checkbox" id="dark-mode-toggle" />
                  <span class="slider round"></span>
                </label>
              </li>
          
              <!-- NOTIFICATION ORDER -->
              <li>
                <span>Notifications</span>
                <select class="menu-select" id="notification-order">
                  <option value="recent">Most Recent</option>
                  <option value="unread">Unread First</option>
                  <option value="priority">Priority</option>
                </select>
              </li>
            </ul>
          </div>
          
          <!-- Notification Icon -->
          <img src="/images/icons/notification.png" alt="Notification Icon" class="notification-icon" tabindex="0" role="button" aria-label="Notifications" />
      
          <!-- User Icon -->
          <img src="/images/icons/user.png" alt="User Icon" class="user-icon" onclick="toggleMenu1(event)" id="profile-icon3" tabindex="0" role="button" aria-label="User Profile" />
          
          <!-- Mini menu for the user -->
          <div id="profile-menu" class="profile-menu">
            <div class="profile-header">
              <img src="/images/icons/account.png" alt="User Icon" class="profile-picture"/>
              <div class="profile-info">
                <span class="profile-name" id="user-username2">@Username</span>
                <p class="profile-fullname" id="given_name2">Name Surname</p>
              </div>
            </div>
            <hr />
            <ul class="menu-links">
              <li onclick="window.location.href='/settings/profile';">
                <img src="/images/icons/user2.png" alt="Profile Icon" class="menu-icon" />
                User Profile
              </li>
              <li>
                <img src="/images/icons/transfer.png" alt="Transfer Icon" class="menu-icon" />
                Settings
              </li>
              <li onclick="log_out(event)">
                <img src="/images/icons/logout.png" alt="Logout Icon" class="menu-icon" />
                Sign Out
              </li>
              <hr />
              <li>
                <a href="/terms" class="menu-link">
                  <img src="/images/terms-and-conditions.png" alt="Terms Icon" class="menu-icon" />
                  Terms &amp; Policies
                </a>
              </li>
              <li>
                <img src="/images/help.png" alt="Help Icon" class="menu-icon" />
                Help
              </li>
            </ul>
          </div>
        </div>
      </header>

    <!-- Crypto Content -->
    <div class="full-width-section">
        <div class="crypto-info">
            <div class="crypto-logo">
                <img src="/images/loading_v2.gif" alt="Crypto Logo" id="crypto-logo">
            </div>
            <div class="crypto-details">
                <h2>
                    <span id="crypto-name">Loading...</span>
                    <span class="crypto-symbol detail-title" id="crypto-symbol2"></span>
                    <img src="/images/none-starred.png" alt="unhighlight icon" class="hilight_icon" id="starred_crypto">
                </h2>
                
                <div class="crypto-stats">
                    <!-- Price Stat -->
                    <div class="stat">
                        <span class="stat-label">Price:</span>
                        <span class="stat-value" id="crypto-price">
                            <img src="/images/small_loading.gif" id="loading-image" alt="Loading" class="mini-loading"/>
                        </span>
                    </div>
                    
                    <!-- Funding Rate Stat -->
                    <div class="stat">
                        <span class="stat-label detail-title">Funding Rate:</span>
                        <div class="description">
                            <p>By taking advantage of the funding rate, you can earn money by strategically opening long or short positions. If the funding rate is positive, you may choose to open a short position, as longs will pay the shorts. Conversely, if the funding rate is negative, opening a long position can be beneficial, since shorts will pay the longs.</p>
                            <p><strong>Note:</strong> The funding rate fluctuates every eight or four hours based on market conditions. The system calculates the funding fee based on the position value at settlement. The paying user will have the funding fee deducted first, and the recipient will receive the amount. However, in cases of liquidation or insufficient margin in isolated margin mode, the recipient might not receive the full amount.</p>
                            <p><strong>Funding fee = position value × funding rate.</strong></p>
                        </div>
                                               
                        <span class="stat-value positive" id="funding-rate-value">Loading...</span>
                    </div>
                    <!-- Countdown -->
                    <div class="stat">
                        <span class="stat-label detail-title">Countdown:</span>
                        <span class="stat-value" id="fundingrate-countdown">00:00:00</span>
                        <div class="description">
                            <p>This countdown shows the time remaining until the next funding rate execution.</p>
                        </div>
                    </div>

                    <!-- Market Cap Stat -->
                    <div class="stat">
                        <span class="stat-label detail-title">Market Cap:</span>
                        <div class="description">
                            <p>The total market value of a cryptocurrency's circulatinzg supply. It is analogous to the free-float capitalization in the stock market.</p>
                            <p>Market Cap = Current Price x Circulating Supply.</p>
                        </div>
                        <span class="stat-value" id="crypto-marketcap">$XXX.XXB</span>
                    </div>
                    <!-- Volume (24h) Stat (No Description) -->
                    <div class="stat">
                        <span class="stat-label detail-title">Volume (24h):</span>
                        <span class="stat-value" id="crypto-volume">$XX.XXB</span>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <!-- Main Content -->
    <div class="main-content" id="main-content">
        <div id="error-message" style="display: none; color: red;"></div>
        <div id="leftPane" class="left-section">
            <!-- Tab Navigation -->
            <div class="left-tab-container">
                <button class="left-tab-button active" onclick="switchLeftPane('chart')">Chart</button>
                <button class="left-tab-button" onclick="switchLeftPane('funding-rate')">Historical Funding Rate</button>
             
            </div>
        
            <!-- Funding Rate Section -->
            <div id="funding-rate" class="left-pane-content active">
                <h2>Historical Funding Rate</h2>
                <div class="chart-container">
                    <canvas id="fundingRateChart"></canvas>
                </div>
            </div>
        
            <!-- Chart Section -->
            <div id="chart" class="left-pane-content" style="position: relative; background-color: #131722;">
                <!-- Custom toolbar for intervals and actions -->
                <div class="chart-controls">
                    <!-- Left Actions: Interval Buttons and Indicators -->
                    <div class="left-actions">
                        <div class="chart-intervals">
                            <button class="interval-button" data-interval="time">Time</button>
                            <button class="interval-button active" data-interval="15">15m</button>
                            <button class="interval-button" data-interval="60">1H</button>
                            <button class="interval-button" data-interval="240">4H</button>
                            <button class="interval-button" data-interval="D">1D</button>
                        </div>
                        <button class="extra-button" id="indicators-button" title="Indicators">
                            <img src="/images/icons/formula.png" alt="Indicators Icon" class="button-icon">
                            <span class="button-text">Indicators</span>
                        </button>
                        <div class="button-divider"></div>
                    </div>

                    <!-- Right Actions: Compare and Screenshot Buttons -->
                    <div class="chart-actions">
                        <button class="extra-button" id="fullscreen-button" title="Fullscreen">
                            <img src="/images/icons/fullscreen.png" alt="Fullscreen Icon" class="button-icon">
                        </button>
                        <button class="extra-button" id="compare-button" title="Compare">
                            <img src="/images/icons/settings.png" alt="Compare Icon" class="button-icon">
                        </button>
                        <button class="extra-button" id="screenshot-button" title="Take Screenshot">
                            <img src="/images/icons/camera.png" alt="Screenshot Icon" class="button-icon">
                        </button>
                    </div>
                </div>

                <div id="tradingview_chart_container" style="position: relative; height: 500px; width: 100%; margin-top: 20px; border-radius: 8px; background: #131722;">

                    <!-- Loading Overlay (shows over the chart area only) -->
                    <div id="chart-loading-overlay" style="position: absolute; top:0; left:0; width:100%; height:100%; background:#131722; display:flex; align-items:center; justify-content:center; z-index:9999;">
                        <div style="width:50%; background:#2e2e2e; border-radius:5px; overflow:hidden;">
                            <!-- Loading Bar -->
                            <div id="chart-loading-bar" style="width:0%; height:10px; background:#3b82f6; transition: width 0.5s;"></div>
                        </div>
                    </div>
                    
                </div>
            </div>



        </div>
        
        <div class="resizer" id="dragMe"></div>

        <div id="rightPane" class="right-section">
            <!-- Tab Section -->
            <div class="tab-section-wrapper">
                <div class="tab-container">
                    <button class="tab-button active" onclick="openTab(event, 'overview')">Overview</button>
                    <button class="tab-button" onclick="openTab(event, 'market-analysis')">Market Analysis</button>
                    <button class="tab-button" onclick="openTab(event, 'crypto-insights')">Crypto Insights</button>
                </div>
                
                <div class="tab-content-wrapper">
                    <div id="overview" class="tab-content active">
                        <p id="crypto-description" class="crypto-description">
                            <img src="/images/spiner_v2.gif" alt="Loading..." id="description-spinner" class="description-spinner">
                            <span id="description-content" style="display: none;">
                                <span id="description-short"></span>
                                <span id="description-full" style="display: none;"></span>
                                <a href="#" id="read-more" onclick="toggleDescription(event)">Read more</a>
                            </span>
                        </p>
                        <p>- Market Sentiment</p>
                        <p>- Daily Trend & Weekly Trend</p>
                    </div>
                    
                    <div id="market-analysis" class="tab-content">
                        <h2>Market Analysis</h2>
                        <p>- Detailed performance data</p>
                        <p>- Price movements and volumes</p>
                        <p>- Technical indicators</p>
                    </div>
                    
                    <div id="crypto-insights" class="tab-content">
                        <h2>Crypto Insights</h2>
                        <p>- Market Sentiment</p>
                        <p>- Weekly Trend & Daily Trend</p>
                        <p>- Potential Opportunities</p>
                    </div>
                </div>
            </div>
        
            <!-- Schedule Trade Section -->
            <div class="tab-section-wrapper">
                <h2>Schedule Trade</h2>
                <div>
                    <button class="open-long-bt">Long</button>
                    <button class="open-short-bt">Short</button>
                </div>
            </div>
        </div>
        
        

    
    <div id="overlay" class="overlay"></div>

    <!-- 404 Error Content -->
    <div id="error-page" class="error-container" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000;">
        <div class="header">
            <img src="/images/leverage_cuck.png" alt="Logo" class="logo">
            <h1>404</h1>
            <img src="/images/leverage_cuck.png" alt="Logo" class="logo">
        </div>
        <h2 class="error-title">Oops!</h2>
        <p class="error-message">The page you are looking for does not exist.</p>
        <button class="home-button" onclick="window.location.href='index.html'">Go Back Home</button>
    </div>
</body>
</html>
