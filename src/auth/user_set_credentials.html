<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add New Trading Account</title>
    <link rel="icon" href="/images/thumnails/original_logo.png" type="image/png">

    <!-- Styles -->
    <link rel="stylesheet" href="/styles/user-set-credentials.css">

    <!-- Scripts: ensure these actually exist and define getCookie / exchangeAPI -->
    <script src="/config.js"></script>
    <script src="/scripts/main-scripts/globalProvider.js" defer></script>
    <script src="/scripts/user-settings/set-credentials.js" defer></script>
</head>
<body>
    <!-- Exchange Selection Screen -->
    <div class="form-container" id="exchange-selection-container">
        <h2>Select Your Exchange</h2>
        <div class="exchange-option-group">
            <!-- Bitget Option -->
            <div class="exchange-option" id="bitget-option">
                <img src="/images/other_images/bitget-img.jpg" alt="Bitget Logo" class="exchange-image">
                <div class="exchange-name">Bitget</div>
                <div class="exchange-description">Trade with Bitget securely and efficiently.</div>
            </div>
            
            <!-- Binance Option -->
            <div class="exchange-option" id="binance-option">
                <img src="/images/other_images/binance-img.png" alt="Binance Logo" class="exchange-image">
                <div class="exchange-name">Binance</div>
                <div class="exchange-description">Join Binance for a wide range of trading options.</div>
            </div>
        </div>
        <p class="label-description-b" style="margin-top: 20px;">
            Currently, we only support these exchanges, but we plan to add more in the future.
        </p>
    </div>

    <!-- Form Container -->
    <div class="form-container" id="form-container" style="display:none;">
        <div class="exchange-heading">
            <h2 id="exchange-heading-text">Connect Exchange</h2>
            <img src="/images/other_images/bitget-loco.svg" alt="Bitget Logo" id="bitget-image" class="exchange-logo" style="display:none;">
            <img src="/images/other_images/binance_logo.png" alt="Binance Logo" id="binance-image" class="exchange-logo" style="display:none;">
        </div>

        <!-- Back to exchange selection link -->
        <p class="label-description-b">
            <a href="#" id="back-to-exchange">← Back</a>
        </p>

        <form id="account-form">
            <!-- Bitget-specific IP Section -->
            <div class="bitget-set-ip" id="bitget-set-ip" style="display: none;">
                <h5>
                    Connect keys securely
                    <a href="/full-guide" class="full-guide-link" target="_blank" rel="noopener noreferrer">
                        Full guide
                        <svg width="12px" height="12px" class="svg-icon" viewBox="0 0 16 16" fill="none">
                            <path fill="currentColor" d="M5.3333 0a.8889.8889 0 110 1.7778H1.7778v12.4444h12.4444v-3.5555a.8889.8889 0 111.7778 0v4.4444a.8889.8889 0 01-.8889.8889H.8889A.8888.8888 0 010 15.1111V.8889A.8889.8889 0 01.8889 0h4.4444zm7.632 1.7778H9.7778a.8889.8889 0 010-1.7778H16v6.2222a.889.889 0 01-1.7778 0V3.0347L8.6284 8.6284a.8887.8887 0 11-1.2568-1.2568l5.5937-5.5938z"></path>
                        </svg>
                    </a>
                </h5>
                <p>This is an additional highlighted section specific to your Bitget connection.</p>
                <p>1. Log in to your exchange account and go to API Settings</p>
                <p>2. Turn on IP whitelisting and copy/paste the following list of IP addresses:</p>
                
                <!-- Copy IP Section -->
                <div class="copy-ip-container">
                    <span id="bitget-ip-label" class="ip-address">Loading...</span>
                    <button type="button" class="copy-ip-button" id="copy-bitget-ip" aria-label="Copy IP Address">
                        <img src="/images/icons/copy.png" alt="Copy IP" class="copy-icon">
                    </button>
                    <span class="copy-tooltip" id="copy-tooltip">Copy IP</span>
                </div>
                
                <p>3. Paste the generated data below.</p>
            </div>                

            <!-- Account Name -->
            <div class="form-group">
                <label for="account_name">Name</label>
                <input type="text" id="account_name" name="account_name" required>
            </div>
            
            <!-- Email Address -->
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>
            
            <input type="hidden" id="exchange_selection" name="exchange_selection">

            <!-- Bitget Fields -->
            <div id="bitget-fields" style="display: none;">
                <div class="form-group">
                    <label for="bitget_api_key">Bitget API Key</label>
                    <input type="text" id="bitget_api_key" name="bitget_api_key" required>
                </div>
                <div class="form-group">
                    <label for="bitget_secret_key">Bitget Secret Key</label>
                    <input type="password" id="bitget_secret_key" name="bitget_secret_key" required>
                </div>
                <div class="form-group">
                    <label for="bitget_passphrase">Bitget Passphrase</label>
                    <input type="text" id="bitget_passphrase" name="bitget_passphrase" required>
                </div>
            </div>

            <!-- Binance Fields -->
            <div id="binance-fields" style="display: none;">
                <div class="form-group">
                    <label for="binance_api_key">Binance API Key</label>
                    <input type="text" id="binance_api_key" name="binance_api_key" required>
                </div>
                <div class="form-group">
                    <label for="binance_secret_key">Binance Secret Key</label>
                    <input type="password" id="binance_secret_key" name="binance_secret_key" required>
                </div>
            </div>

            <button type="submit" id="submit-button">
                Connect Exchange
                <img src="/images/lock.png" alt="Secure Submit" class="submit-lock-icon">
            </button>

            <!-- Security message and encourage message area -->
            <div class="security-message">
                <span id="encourage-message"></span>
            </div>

        </form>
    </div>

    <!-- Success Screen -->
    <div id="success-screen" style="display:none;">
        <div class="confirmation-container">
            <h3>Success!</h3>
            <div class="sucess-section">
                <img src="/images/icons/success.png" alt="Success Icon" class="success-icon">
                <span>
                    We've successfully added your account.
                </span>
            </div>

            <h2>You can close this window</h2>
        </div>
    </div>

    <!-- Failure Screen -->
    <div id="failure-screen" style="display:none;">
        <div class="confirmation-container">
            <!-- The close "X" -->
            <span class="close-modal" title="Close">×</span>
            <h3>Error Verifying Credentials</h3>
    
            <div class="warning-section">
                <img src="/images/icons/warning.png" alt="Warning Icon" class="warning-icon">
                <span id="failure-message">
                    We encountered an issue while verifying your credentials. Please review the following steps to resolve it.
                </span>
            </div>
    
            <ul class="error-steps-list">
                <li>Ensure your username and password are entered correctly.</li>
                <li>Verify that your API key or token is valid and has not expired.</li>
                <li>Check if your IP address is whitelisted in your security settings.</li>
                <li>Ensure you have the necessary permissions to access this resource.</li>
                <li>If the error persists, contact support for further assistance.</li>
            </ul>
    
            <div class="button-group">
                <button id="failure-retry-button" class="highlighted-button">Retry</button>
                <button id="failure-cancel-button">Go Back</button>
            </div>
        </div>
    </div>
    
      

    <!-- Loading Bar Container -->
    <div class="loading-container" id="loading-bar" style="display: none;">
        <div class="loading-bar"></div>
    </div>
</body>
</html>
